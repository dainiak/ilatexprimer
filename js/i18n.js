let I18N_STRINGS_ALL = {
    "ru": {
        "document.title": "Интерактивное введение в LaTeX",

        "loadingToast": "Идёт загрузка страницы…",
        "githubForkLink": "Проект на GitHub",
        "collapseExpandSteps": "Свернуть/развернуть все шаги урока",
        "mainTitle": "Интерактивное введение в \\( \\LaTeX \\)",
        "headerAbout": "Об уроке",
        "contentAbout": "<p>Урок задуман, свёрстан и запрограммирован <a rel=\"author\" href=\"http://www.dainiak.com\">Александром Дайняком</a>, доцентом <a href=\"https://mipt.ru/\">МФТИ</a>. Почтовый адрес для связи: <code>dainiak@gmail.com</code></p><p>Урок создан с использованием <a href=\"https://www.mathjax.org/\">MathJax</a>, <a href=\"https://katex.org/\">KaTeX</a>, <a href=\"https://ace.c9.io\">ACE Editor</a>, <a href=\"http://getbootstrap.com/\">Bootstrap</a>, <a href=\"https://jquery.com/\">jQuery</a>. В перечисленных инструментах и в тонкостях использования \\(\\LaTeX\\) автору помогали разбираться форумы <a href=\"http://stackoverflow.com/\">Stack Overflow</a> и <a href=\"http://tex.stackexchange.com/\">LaTeX Stack Exchange</a>. Сильно облегчали написание и тестирование кода редактор <a href=\"https://www.jetbrains.com/pycharm/\">PyCharm</a> и панель разработчика в <a href=\"https://www.google.com/chrome/\">Chrome</a>. Хостинг проекта осуществляется на <a href=\"https://github.com/dainiak/ilatexprimer\">GitHub</a>.</p>",
        "btnCollapseAll": "Свернуть все шаги",
        "btnExpandAll": "Развернуть все шаги",
        "headerKeywordSearch": "Поиск по ключевым словам",
        "headerOptions": "Дополнительные настройки",
        "headerMathEngine": "Движок, используемый для отображения формул при редактировании кода",
        "optionMathEngineMathJax": "MathJax (чуть медленнее, но вернее)",
        "optionMathEngineKaTeX": "KaTeX (быстрее, но не всё может корректно отображаться)",
        "headerInteractivityMode": "Когда отображать то, что набрано в окне редактирования кода",
        "optionInteractivityHigh": "При любых изменениях кода в редакторе (веселее)",
        "optionInteractivityLow": "Только по нажатии <code>Ctrl+Enter</code> в редакторе (может быть надёжнее)",
        "headerEditorInstances": "Количество окон редактора кода",
        "optionEditorMultiple": "По одному редактору для каждого шага (удобнее)",
        "optionEditorSingle": "Редактор только для активного шага (меньшая нагрузка на браузер)",
        "headerSourceResultRatio": "Отношение ширин окон с текстом и исходным кодом (на широком экране)",
        "optionNoSourseCode": "без кода",

        "headerDisplayLanguage": "Язык отображения",
        "optionLanguageRU": "русский",
        "optionLanguageEN": "английский",

        "confirmation.SwitchToKaTeX": "Рекомендуется в этом случае использовать для отображения формул KaTeX. Переключиться на KaTeX?",
        "confirmation.CtrlEnter": "Рекомендуется при этом переключиться в режим отображения только по Ctrl+Enter. Переключиться?",
        "confirmation.KaTeXLowerCompatibility": "Отображение формул будет хуже соответствовать «настоящему» LaTeX. Вы уверены?",

        "msg.UnbalancedParenthesis": "((Несбалансированные скобки!))",
        "msg.KatexUnableToDisplayFormula": "(KaTeX не смог отобразить эту формулу)",
        "msg.ProcessingMathOnPage": "Идёт отрисовка формул. На медленном компьютере может занять десятки секунд…",
        "msg.LoadingSection": "Загружается раздел",
        "msg.ProcessingSection": "Обрабатывается раздел",
        "msg.UnableToLoadThisStep": "Не удалось загрузить этот шаг",
        "msg.FinishedLoading": "Загрузка завершена. Поехали!",
    },
    "en": {
        "document.title": "Interactive Introduction to \\( \\LaTeX \\)",

        "loadingToast": "Loading…",
        "githubForkLink": "Fork me on GitHub",
        "collapseExpandSteps": "Collapse/expand all steps",
        "mainTitle": "Interactive Introduction to \\( \\LaTeX \\)",
        "headerAbout": "About",
        "contentAbout": "<p>This interactive lesson is created by <a rel=\"author\" href=\"http://www.dainiak.com\">Alex Dainiak</a>, an associate professor at <a href=\"https://mipt.ru/en/\">MIPT</a>. Email: <code>dainiak@gmail.com</code></p><p>The lesson is powered by <a href=\"https://www.mathjax.org/\">MathJax</a>, <a href=\"https://khan.github.io/KaTeX/\">KaTeX</a>, <a href=\"https://ace.c9.io\">ACE Editor</a>, <a href=\"http://getbootstrap.com/\">Bootstrap</a>, <a href=\"https://jquery.com/\">jQuery</a>. While preparing this lesson, the author benefited much from <a href=\"http://stackoverflow.com/\">Stack Overflow</a> and <a href=\"http://tex.stackexchange.com/\">LaTeX Stack Exchange</a>. Programming this lesson was made fun by <a href=\"https://www.jetbrains.com/pycharm/\">PyCharm</a> IDE and <a href=\"https://www.google.com/chrome/\">Chrome</a> developer tools. This project is hosted on <a href=\"https://github.com/dainiak/ilatexprimer\">GitHub</a>.</p>",
        "btnCollapseAll": "Collapse all",
        "btnExpandAll": "Expand all",
        "headerKeywordSearch": "Smart search",
        "headerOptions": "Options",
        "headerMathEngine": "Math display engine",
        "optionMathEngineMathJax": "MathJax (better LaTeX compatibility)",
        "optionMathEngineKaTeX": "KaTeX (faster)",
        "headerInteractivityMode": "When to process the LaTeX source code",
        "optionInteractivityHigh": "On any update of the source code (more fun)",
        "optionInteractivityLow": "Only when <code>Ctrl+Enter</code> is pressed in the source code editor (more stable)",
        "headerEditorInstances": "Number of source code editor instances",
        "optionEditorMultiple": "Separate editor per each step (more convenient)",
        "optionEditorSingle": "Single editor instance (lower memory load)",
        "headerSourceResultRatio": "Result/source code window ratio",
        "optionNoSourseCode": "no source code",

        "headerDisplayLanguage": "Language",
        "optionLanguageRU": "Russian",
        "optionLanguageEN": "English",

        "confirmation.SwitchToKaTeX": "It is recommended to use KaTeX for math display in this case. Do you want to switch to KaTeX?",
        "confirmation.CtrlEnter": "It is recommended to switch to “Crtl+Enter only” update mode. Make the switch?",
        "confirmation.KaTeXLowerCompatibility": "KaTeX supports a smaller subset of LaTeX commands. Are you sure you want to switch?",

        "msg.UnbalancedParenthesis": "((Несбалансированные скобки!))",
        "msg.KatexUnableToDisplayFormula": "(KaTeX was unable to process the formula)",
        "msg.ProcessingMathOnPage": "Processing math on page. On slow computer this may take a while…",
        "msg.LoadingSection": "Loading section",
        "msg.ProcessingSection": "Processing section",
        "msg.UnableToLoadThisStep": "Unable to load this step",
        "msg.FinishedLoading": "Finished loading. Have fun!",
    }
};

function setUILanguage(language=null){
    if(!language)
        language = navigator.languages.indexOf('ru') >= 0 ? 'ru' : 'en';

    window.I18N_STRINGS = I18N_STRINGS_ALL[language];
    window.confirmationSwitchToKaTeX = I18N_STRINGS["confirmation.SwitchToKaTeX"];
    window.confirmationCtrlEnter = I18N_STRINGS["confirmation.CtrlEnter"];
    window.confirmationKaTeXLowerCompatibility = I18N_STRINGS["confirmation.KaTeXLowerCompatibility"];
    window.msgUnbalancedParenthesis = I18N_STRINGS["msg.UnbalancedParenthesis"] || "((Unbalanced parentheses))";
    window.msgKatexUnableToDisplayFormula = I18N_STRINGS["msg.KatexUnableToDisplayFormula"];
    window.msgProcessingMathOnPage = I18N_STRINGS["msg.ProcessingMathOnPage"];
    window.msgLoadingSection = I18N_STRINGS["msg.LoadingSection"];
    window.msgProcessingSection = I18N_STRINGS["msg.ProcessingSection"];
    window.msgUnableToLoadThisStep = I18N_STRINGS["msg.UnableToLoadThisStep"];
    window.msgFinishedLoading = I18N_STRINGS["msg.FinishedLoading"];

    document.title = I18N_STRINGS['document.title'] ? I18N_STRINGS['document.title'] : document.title;
    for(let paramId in I18N_STRINGS){
        if(paramId.indexOf('.') < 0){
            $('#' + paramId).html(I18N_STRINGS[paramId]);
        }
    }
    let $languageSelector = $('input[type=radio][name=displayLanguage][value=' + language + ']');
    if($languageSelector[0])
        $languageSelector[0].checked = true;

    window.lessonLanguage = language;
}